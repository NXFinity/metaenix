"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[3405],{7904:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"events/subscribing","title":"Subscribing to Events","description":"Learn how to connect to the Meta EN|IX WebSocket server and subscribe to events.","source":"@site/docs/events/subscribing.md","sourceDirName":"events","slug":"/events/subscribing","permalink":"/metaenix/docs/events/subscribing","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/events/subscribing.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Events Introduction","permalink":"/metaenix/docs/events/intro"},"next":{"title":"Using Events","permalink":"/metaenix/docs/events/using"}}');var t=r(4848),s=r(8453);const c={sidebar_position:2},i="Subscribing to Events",l={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"WebSocket Endpoint",id:"websocket-endpoint",level:2},{value:"Connection Methods",id:"connection-methods",level:2},{value:"Method 1: Query Parameter",id:"method-1-query-parameter",level:3},{value:"Method 2: Authorization Header",id:"method-2-authorization-header",level:3},{value:"Method 3: Custom Header",id:"method-3-custom-header",level:3},{value:"Connection Events",id:"connection-events",level:2},{value:"Connection Successful",id:"connection-successful",level:3},{value:"Connection Error",id:"connection-error",level:3},{value:"Disconnection",id:"disconnection",level:3},{value:"Subscribing to Events",id:"subscribing-to-events-1",level:2},{value:"Subscribe to Follow Events",id:"subscribe-to-follow-events",level:3},{value:"Listen for Follow Events",id:"listen-for-follow-events",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Reconnection Handling",id:"reconnection-handling",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"subscribing-to-events",children:"Subscribing to Events"})}),"\n",(0,t.jsx)(n.p,{children:"Learn how to connect to the Meta EN|IX WebSocket server and subscribe to events."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"Before subscribing to events, you need:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Application Credentials"})," - Your ",(0,t.jsx)(n.code,{children:"clientId"})," and ",(0,t.jsx)(n.code,{children:"clientSecret"})," from app registration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WebSocket ID"})," - Your application's unique ",(0,t.jsx)(n.code,{children:"websocketId"})," (obtained during app registration)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WebSocket Client"})," - A Socket.IO client library for your platform"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"websocket-endpoint",children:"WebSocket Endpoint"}),"\n",(0,t.jsx)(n.p,{children:"Connect to the Meta EN|IX WebSocket server:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"wss://api.metaenix.com\n"})}),"\n",(0,t.jsx)(n.h2,{id:"connection-methods",children:"Connection Methods"}),"\n",(0,t.jsx)(n.h3,{id:"method-1-query-parameter",children:"Method 1: Query Parameter"}),"\n",(0,t.jsxs)(n.p,{children:["Include your ",(0,t.jsx)(n.code,{children:"websocketId"})," as a query parameter:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"import { io } from 'socket.io-client';\r\n\r\nconst socket = io('https://api.metaenix.com/account', {\r\n  query: {\r\n    websocketId: 'your-websocket-id-here'\r\n  },\r\n  transports: ['websocket'],\r\n  reconnection: true,\r\n  reconnectionDelay: 1000,\r\n  reconnectionAttempts: 5\r\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"method-2-authorization-header",children:"Method 2: Authorization Header"}),"\n",(0,t.jsxs)(n.p,{children:["Include your ",(0,t.jsx)(n.code,{children:"websocketId"})," in the authorization header:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const socket = io('https://api.metaenix.com/account', {\r\n  auth: {\r\n    websocketId: 'your-websocket-id-here'\r\n  },\r\n  transports: ['websocket'],\r\n  reconnection: true\r\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"method-3-custom-header",children:"Method 3: Custom Header"}),"\n",(0,t.jsxs)(n.p,{children:["Include your ",(0,t.jsx)(n.code,{children:"websocketId"})," in a custom header:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const socket = io('https://api.metaenix.com/account', {\r\n  extraHeaders: {\r\n    'x-websocket-id': 'your-websocket-id-here'\r\n  },\r\n  transports: ['websocket']\r\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"connection-events",children:"Connection Events"}),"\n",(0,t.jsx)(n.h3,{id:"connection-successful",children:"Connection Successful"}),"\n",(0,t.jsxs)(n.p,{children:["When successfully connected, you'll receive a ",(0,t.jsx)(n.code,{children:"connected"})," event:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"socket.on('connected', (data) => {\r\n  console.log('Connected:', data);\r\n  // {\r\n  //   message: 'Connected to account gateway',\r\n  //   websocketId: 'your-websocket-id',\r\n  //   userId: 'user-id-if-authenticated',\r\n  //   username: 'username-if-authenticated'\r\n  // }\r\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"connection-error",children:"Connection Error"}),"\n",(0,t.jsx)(n.p,{children:"Handle connection errors:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"socket.on('error', (error) => {\r\n  console.error('Connection error:', error);\r\n  // {\r\n  //   message: 'Connection failed: Invalid websocketId'\r\n  // }\r\n});\r\n\r\nsocket.on('connect_error', (error) => {\r\n  console.error('Connect error:', error.message);\r\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"disconnection",children:"Disconnection"}),"\n",(0,t.jsx)(n.p,{children:"Handle disconnection events:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"socket.on('disconnect', (reason) => {\r\n  console.log('Disconnected:', reason);\r\n  // Reasons: 'io server disconnect', 'io client disconnect', \r\n  //          'ping timeout', 'transport close', 'transport error'\r\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"subscribing-to-events-1",children:"Subscribing to Events"}),"\n",(0,t.jsx)(n.h3,{id:"subscribe-to-follow-events",children:"Subscribe to Follow Events"}),"\n",(0,t.jsxs)(n.p,{children:["Connect to the ",(0,t.jsx)(n.code,{children:"/follows"})," namespace and subscribe:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const followsSocket = io('https://api.metaenix.com/follows', {\r\n  query: {\r\n    websocketId: 'your-websocket-id-here'\r\n  }\r\n});\r\n\r\n// Subscribe to follow events\r\nfollowsSocket.emit('subscribe_follows', {}, (response) => {\r\n  console.log('Subscribed:', response);\r\n  // {\r\n  //   event: 'subscribed',\r\n  //   room: 'user:user-id'\r\n  // }\r\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"listen-for-follow-events",children:"Listen for Follow Events"}),"\n",(0,t.jsx)(n.p,{children:"After subscribing, listen for events:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// New follower notification\r\nfollowsSocket.on('new_follower', (data) => {\r\n  console.log('New follower:', data);\r\n  // {\r\n  //   followerId: 'user-id-of-follower',\r\n  //   timestamp: '2025-01-15T10:00:00Z'\r\n  // }\r\n});\r\n\r\n// Unfollow notification\r\nfollowsSocket.on('unfollow', (data) => {\r\n  console.log('User unfollowed:', data);\r\n  // {\r\n  //   followerId: 'user-id-who-unfollowed',\r\n  //   timestamp: '2025-01-15T10:00:00Z'\r\n  // }\r\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsx)(n.p,{children:"Here's a complete example using Node.js:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"import { io } from 'socket.io-client';\r\n\r\nclass MetaEnixEvents {\r\n  constructor(websocketId) {\r\n    this.websocketId = websocketId;\r\n    this.sockets = {};\r\n  }\r\n\r\n  connect(namespace = 'account') {\r\n    const socket = io(`https://api.metaenix.com/${namespace}`, {\r\n      query: {\r\n        websocketId: this.websocketId\r\n      },\r\n      transports: ['websocket'],\r\n      reconnection: true,\r\n      reconnectionDelay: 1000,\r\n      reconnectionAttempts: 5\r\n    });\r\n\r\n    socket.on('connect', () => {\r\n      console.log(`Connected to ${namespace} namespace`);\r\n    });\r\n\r\n    socket.on('connected', (data) => {\r\n      console.log('Authenticated:', data);\r\n    });\r\n\r\n    socket.on('error', (error) => {\r\n      console.error('Error:', error);\r\n    });\r\n\r\n    socket.on('disconnect', (reason) => {\r\n      console.log('Disconnected:', reason);\r\n    });\r\n\r\n    this.sockets[namespace] = socket;\r\n    return socket;\r\n  }\r\n\r\n  subscribeToFollows() {\r\n    const socket = this.connect('follows');\r\n    \r\n    socket.emit('subscribe_follows', {}, (response) => {\r\n      console.log('Subscribed to follows:', response);\r\n    });\r\n\r\n    socket.on('new_follower', (data) => {\r\n      this.handleNewFollower(data);\r\n    });\r\n\r\n    socket.on('unfollow', (data) => {\r\n      this.handleUnfollow(data);\r\n    });\r\n\r\n    return socket;\r\n  }\r\n\r\n  handleNewFollower(data) {\r\n    console.log('New follower event:', data);\r\n    // Implement your event handling logic here\r\n  }\r\n\r\n  handleUnfollow(data) {\r\n    console.log('Unfollow event:', data);\r\n    // Implement your event handling logic here\r\n  }\r\n\r\n  disconnect(namespace) {\r\n    if (this.sockets[namespace]) {\r\n      this.sockets[namespace].disconnect();\r\n      delete this.sockets[namespace];\r\n    }\r\n  }\r\n\r\n  disconnectAll() {\r\n    Object.keys(this.sockets).forEach(namespace => {\r\n      this.disconnect(namespace);\r\n    });\r\n  }\r\n}\r\n\r\n// Usage\r\nconst events = new MetaEnixEvents('your-websocket-id-here');\r\nevents.subscribeToFollows();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"reconnection-handling",children:"Reconnection Handling"}),"\n",(0,t.jsx)(n.p,{children:"Socket.IO automatically handles reconnections. You can customize the behavior:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const socket = io('https://api.metaenix.com/account', {\r\n  query: {\r\n    websocketId: 'your-websocket-id-here'\r\n  },\r\n  reconnection: true,\r\n  reconnectionDelay: 1000,        // Wait 1 second before reconnecting\r\n  reconnectionDelayMax: 5000,     // Maximum delay between reconnection attempts\r\n  reconnectionAttempts: 5,        // Maximum number of reconnection attempts\r\n  timeout: 20000                   // Connection timeout\r\n});\r\n\r\nsocket.on('reconnect', (attemptNumber) => {\r\n  console.log(`Reconnected after ${attemptNumber} attempts`);\r\n});\r\n\r\nsocket.on('reconnect_attempt', (attemptNumber) => {\r\n  console.log(`Reconnection attempt ${attemptNumber}`);\r\n});\r\n\r\nsocket.on('reconnect_failed', () => {\r\n  console.error('Failed to reconnect after maximum attempts');\r\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.p,{children:"Always implement proper error handling:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"socket.on('error', (error) => {\r\n  if (error.message.includes('Invalid websocketId')) {\r\n    // Handle authentication error\r\n    console.error('Authentication failed - check websocketId');\r\n  } else if (error.message.includes('Unauthorized')) {\r\n    // Handle authorization error\r\n    console.error('Not authorized to access this namespace');\r\n  } else {\r\n    // Handle other errors\r\n    console.error('Unexpected error:', error);\r\n  }\r\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Store websocketId Securely"})," - Never expose your websocketId in client-side code"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Handle Reconnections"})," - Implement reconnection logic for production"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Validate Events"})," - Always validate event payloads before processing"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Rate Limiting"})," - Be aware of rate limits on event subscriptions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Error Handling"})," - Implement comprehensive error handling"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Connection Management"})," - Properly disconnect when done"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"./using",children:"Using Events"})})," - Learn how to handle and process events"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"./payloads",children:"Event Payloads"})})," - Reference for all event types and payloads"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>i});var o=r(6540);const t={},s=o.createContext(t);function c(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);